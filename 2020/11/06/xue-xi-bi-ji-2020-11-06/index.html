<!DOCTYPE html>
<html lang="en">
  <head>
    <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    name="viewport"
  />
  <title>Drowning me></title>
  <link rel="stylesheet" href="/css/style.css">

<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>

  </head>
  <body>
    <div class="container">
      <header class="header">
  <div class="blog-title">
    <a href="/" class="logo">Drowning me</a>
  </div>
  <nav class="navbar">
    <ul class="menu">
      
      <li class="menu-item">
        <a href="/" class="menu-item-link"
          >home</a
        >
      </li>
      
      <li class="menu-item">
        <a href="/categories" class="menu-item-link"
          >categories</a
        >
      </li>
      
      <li class="menu-item">
        <a href="/tags" class="menu-item-link"
          >tags</a
        >
      </li>
      
      <li class="menu-item">
        <a href="/archives" class="menu-item-link"
          >archives</a
        >
      </li>
      
      <li class="menu-item">
        <a href="/about" class="menu-item-link"
          >about</a
        >
      </li>
      
    </ul>
  </nav>
</header>
 <article class="post">
    <div class="post-title">
        <h2 class="title">学习笔记 2020 11 06</h2>
    </div>
    <div class="post-meta">
        <span class="post-time">2020-11-06</span>
    </div>
    <div class="post-content">
        <h1 id="学习笔记-2020-11-06"><a href="#学习笔记-2020-11-06" class="headerlink" title="学习笔记 2020-11-06"></a>学习笔记 2020-11-06</h1><a id="more"></a>

<h2 id="JavaScript-高级程序设计-第4版-阅读记录"><a href="#JavaScript-高级程序设计-第4版-阅读记录" class="headerlink" title="JavaScript 高级程序设计(第4版) 阅读记录"></a>JavaScript 高级程序设计(第4版) 阅读记录</h2><h3 id="客户端检测"><a href="#客户端检测" class="headerlink" title="客户端检测"></a>客户端检测</h3><h4 id="软件与硬件检测"><a href="#软件与硬件检测" class="headerlink" title="软件与硬件检测"></a>软件与硬件检测</h4><h5 id="浏览器元数据"><a href="#浏览器元数据" class="headerlink" title="浏览器元数据"></a>浏览器元数据</h5><ol>
<li><p>Battery Status API</p>
<p>浏览器可以访问设备电池及充电状态的信息。<code>navigator.getBattery()</code> 方法会返回一个期约实例，解决为一个 <code>BatteryManager</code> 对象，包含四个只读属性：</p>
<ul>
<li><code>charging</code> 布尔值，表示设备当前是否正接入电源充电，如果设备没有电池，则返回 <code>true</code> 。</li>
<li><code>chargingTime</code> 整数，表示预计离电池充满还有多少秒。如果电池已充满或设备没有电池，则返回 0 。</li>
<li><code>dischargingTime</code> 整数，表示预计离电量耗尽还有多少秒，如果设备没有电池，则返回 Infinity 。</li>
<li><code>level</code> 浮点数，表示电量百分比。电量完全耗尽返回 <code>0.0</code> ，电池充满或设备没有电池则返回 <code>1.0</code> 。</li>
</ul>
<p>这个 API 还提供了 4 个事件属性，可用于设置在相应的电池事件发生时调用的回调函数。</p>
<ul>
<li>onchargingchange</li>
<li>onchargingtimechange</li>
<li>ondischargingtimechange</li>
<li>onlevelchange</li>
</ul>
<pre class=" language-js"><code class="language-js">navigator<span class="token punctuation">.</span><span class="token function">getBattery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>battery <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// 添加充电状态变化时的处理程序</span>
  <span class="token keyword">const</span> chargingChangeHandler <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'chargingchange'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  battery<span class="token punctuation">.</span>onchargingchange <span class="token operator">=</span> chargingChangeHandler<span class="token punctuation">;</span>
  <span class="token comment" spellcheck="true">// 或</span>
  battery<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'chargingchange'</span><span class="token punctuation">,</span> chargingChangeHandler<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment" spellcheck="true">// 添加充电时间变化时的处理程序</span>
  <span class="token keyword">const</span> chargingTimeChangeHandler <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'chargingtimechange'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  battery<span class="token punctuation">.</span>onchargingtimechange <span class="token operator">=</span> chargingTimeChangeHandler<span class="token punctuation">;</span>
  <span class="token comment" spellcheck="true">// 或</span>
  battery<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'chargingtimechange'</span><span class="token punctuation">,</span> chargingTimeChangeHandler<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment" spellcheck="true">// 添加放电时间变化时的处理程序</span>
  <span class="token keyword">const</span> dischargingTimeChangeHandler <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'dischargingtimechange'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  battery<span class="token punctuation">.</span>ondischargingtimechange <span class="token operator">=</span> dischargingTimeChangeHandler<span class="token punctuation">;</span>
  <span class="token comment" spellcheck="true">// 或</span>
  battery<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'dischargingtimechange'</span><span class="token punctuation">,</span> dischargingTimeChangeHandler<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment" spellcheck="true">// 添加电量百分比变化时的处理程序</span>
  <span class="token keyword">const</span> levelChangeHandler <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'levelchange'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  battery<span class="token punctuation">.</span>onlevelchange <span class="token operator">=</span> levelChangeHandler<span class="token punctuation">;</span>
  <span class="token comment" spellcheck="true">// 或</span>
  battery<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'levelchange'</span><span class="token punctuation">,</span> levelChangeHandler<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</li>
</ol>
<h5 id="硬件"><a href="#硬件" class="headerlink" title="硬件"></a>硬件</h5><ol>
<li><p>处理器核心数</p>
<p><code>navigator.hardwareConcurrency</code> 属性返回浏览器支持的逻辑处理器核心数量，包含表示核心数的一个整数值。这个值表示浏览器可以并行执行的最大工作线程数量，不一定是实际的 CPU 核心数。</p>
</li>
<li><p>设备内存大小、</p>
<p><code>navigator.deviceMemory</code> 属性返回设备大致的系统内存大小，包含单位为 GB 的浮点数。</p>
</li>
<li><p>最大触点数</p>
<p><code>navigator.maxTouchPoints</code> 属性返回触摸屏支持的最大关联触点数量，包含一个整数值。</p>
</li>
</ol>
<h3 id="DOM"><a href="#DOM" class="headerlink" title="DOM"></a>DOM</h3><p>HTMl 中的每段标记都可以表示为一个节点。DOM 中总共有 12 种节点类型，这些类型都继承一种基本类型。</p>
<h4 id="节点层级"><a href="#节点层级" class="headerlink" title="节点层级"></a>节点层级</h4><h5 id="Node-类型"><a href="#Node-类型" class="headerlink" title="Node 类型"></a>Node 类型</h5><p>DOM Level 1 描述了名为 Node 的接口，这个接口是所有 DOM 节点类型都必须实现的。 Node 接口在 JavaScript 中被实现为 Node 类型，在除 IE 之外的所有浏览器中都可以直接访问这个类型。在 JavaScript 中，所有节点类型都继承 Node 类型，因此所有类型都共享相同的基本属性和方法。</p>
<p>每个节点都有 nodeType 属性，表示该节点的类型。节点类型由定义在 Node 类型上的 12 个数值常量表示：</p>
<ul>
<li>Node.ELEMENT_NODE ( 1 )</li>
<li>Node.ATTRIBUTE_NODE ( 2 )</li>
<li>Node.TEXT_NODE ( 3 )</li>
<li>Node.CDATA_SECTION_NODE ( 4 )</li>
<li>Node.ENTITY_PEFERENCE_NODE ( 5 )</li>
<li>Node.ENTITY_NODE ( 6 )</li>
<li>Node.PROCESSING_INSTRUCTION_NODE ( 7 )</li>
<li>Node.COMMENT_NODE ( 8 )</li>
<li>Node.DOCUMENT_NODE ( 9 )</li>
<li>Node.DOCUMENT_TYPE_NODE ( 10 )</li>
<li>Node.DOCUMENT_FRAGMENT_NODE ( 11 )</li>
<li>Node.NOTATION_NODE ( 12 )</li>
</ul>
<p>节点类型可以通过与这些常量比较来确定：</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span>someNode<span class="token punctuation">.</span>nodeType <span class="token operator">==</span> Node<span class="token punctuation">.</span>ELEMENT_NODE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Node is an element.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>浏览器并不支持所有节点类型。</p>
<ol>
<li><p>nodeName 与 nodeValue</p>
<p>nodeName 与 nodeValue 保存着有关节点的信息。这两个属性的值完全取决于节点类型。在使用这两个属性前，最好先检测节点类型。</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span>someNode<span class="token punctuation">.</span>nodeType <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  value <span class="token operator">=</span> someNode<span class="token punctuation">.</span>nodeName<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 会显示元素的标签名</span>
<span class="token punctuation">}</span></code></pre>
<p>对元素而言，nodeName 始终等于元素的标签名，而 nodeValue 则始终为 null 。</p>
</li>
<li><p>节点关系</p>
<p>每个节点有一个 childNodes 属性，其中包含一个 NodeList 的实例。NodeList 是一个类数组对象，用于存储可以按位置存取的有序节点。NodeList 对象独特的地方在于，它其实是一个对 DOM 结构的查询，因此 DOM 结构的变化会自动地在 NodeList 中反映出来。NodeList 是实时的活动对象，而不是第一次访问时所获的内容的快照。</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">let</span> firstChild <span class="token operator">=</span> someNode<span class="token punctuation">.</span>childNodes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> secondChild <span class="token operator">=</span> someNode<span class="token punctuation">.</span>childNodes<span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> count <span class="token operator">=</span> someNode<span class="token punctuation">.</span>childNodes<span class="token punctuation">.</span>length<span class="token punctuation">;</span></code></pre>
<p>每个节点有一个 parentNode 属性，指向其 DOM 树中的父元素。</p>
<p>childNodes 列表中的每个节点都是同一列表中其他节点的同胞节点，使用 previousSibling 和 nextSibling 可以在这个列表的节点间导航。列表中第一个节点和最后一个节点的同胞属性为 null 。</p>
<p>父节点和它的第一个及最后一个子节点也有专门属性：</p>
<ul>
<li>firstChild</li>
<li>lastChild</li>
</ul>
<p>还有一个方法是 <code>hasChildNodes()</code> ，可以判断节点是否有一个或多个子节点。</p>
<p>所有节点共享一个关系： ownerDocument 属性是一个指向代表整个文档的文档节点的指针。所有节点都被创建它们的文档所拥有。</p>
</li>
</ol>
<h2 id="现代-JavaScript-教程"><a href="#现代-JavaScript-教程" class="headerlink" title="现代 JavaScript 教程"></a>现代 JavaScript 教程</h2><h3 id="任务"><a href="#任务" class="headerlink" title="任务"></a>任务</h3><ol>
<li><p>过滤数组中的唯一元素</p>
<p>定义 <code>arr</code> 为一个数组。</p>
<p>创建一个函数 <code>unique(arr)</code>，该函数返回一个由 <code>arr</code> 中所有唯一元素所组成的数组。</p>
<p>例如：</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">unique</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">/* 你的代码 */</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Hare"</span><span class="token punctuation">,</span> <span class="token string">"Krishna"</span><span class="token punctuation">,</span> <span class="token string">"Hare"</span><span class="token punctuation">,</span> <span class="token string">"Krishna"</span><span class="token punctuation">,</span>
  <span class="token string">"Krishna"</span><span class="token punctuation">,</span> <span class="token string">"Krishna"</span><span class="token punctuation">,</span> <span class="token string">"Hare"</span><span class="token punctuation">,</span> <span class="token string">"Hare"</span><span class="token punctuation">,</span> <span class="token string">":-O"</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token function">alert</span><span class="token punctuation">(</span> <span class="token function">unique</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Hare, Krishna, :-O</span></code></pre>
<p>P.S. 这里用到了 string 类型，但其实可以是任何类型的值。</p>
<p>P.S. 使用 <code>Set</code> 来存储唯一值。</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">unique</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Array<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
</li>
<li><p>过滤字谜</p>
<p><a href="https://en.wikipedia.org/wiki/Anagram" target="_blank" rel="noopener">Anagrams</a> 是具有相同数量相同字母但是顺序不同的单词。</p>
<p>例如：</p>
<pre class=" language-none"><code class="language-none">nap - pan
ear - are - era
cheaters - hectares - teachers</code></pre>
<p>写一个函数 <code>aclean(arr)</code>，它返回被清除了字谜（anagrams）的数组。</p>
<p>例如：</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"nap"</span><span class="token punctuation">,</span> <span class="token string">"teachers"</span><span class="token punctuation">,</span> <span class="token string">"cheaters"</span><span class="token punctuation">,</span> <span class="token string">"PAN"</span><span class="token punctuation">,</span> <span class="token string">"ear"</span><span class="token punctuation">,</span> <span class="token string">"era"</span><span class="token punctuation">,</span> <span class="token string">"hectares"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token function">alert</span><span class="token punctuation">(</span> <span class="token function">aclean</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// "nap,teachers,ear" or "PAN,cheaters,era"</span></code></pre>
<p>对于所有的字谜（anagram）组，都应该保留其中一个词，但保留的具体是哪一个并不重要。</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">aclean</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> <span class="token keyword">set</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> newArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>item <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> tmp <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">set</span><span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      newArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">set</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> newArr<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">// 参考解决方案</span>
<span class="token keyword">function</span> <span class="token function">aclean</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> word <span class="token keyword">of</span> arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 将单词 split 成字母，对字母进行排序，之后再 join 回来</span>
    <span class="token keyword">let</span> sorted <span class="token operator">=</span> word<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// (*)</span>
    map<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>sorted<span class="token punctuation">,</span> word<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> Array<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
</li>
<li><p>迭代键</p>
<p>我们期望使用 <code>map.keys()</code> 得到一个数组，然后使用特定的方法例如 <code>.push</code> 等，对其进行处理。</p>
<p>但是运行不了：</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">let</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

map<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"John"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> keys <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// Error: keys.push is not a function</span>
keys<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"more"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>为什么？我们应该如何修改代码让 <code>keys.push</code> 工作？</p>
<p><code>map.keys()</code> 返回值是一个可迭代对象，不是数组。</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">let</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

map<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'John'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> keys <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
keys<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'more'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>keys<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// ["name", "more"]</span></code></pre>
</li>
</ol>

    </div>
</article>
 <footer>
  <p>
    Theme is <a href="/" target="_blank">Theme-example</a> by
    <a href="https://s1rine.github.io" target="_blank">Sirine</a>
  </p>
  <p>
    Powered by
    <a href="https://hexo.io/" target="_blank" rel="nofollow">hexo</a>
    &copy; 2021
  </p>
</footer>

    </div>
  </body>
</html>
