<!DOCTYPE html>
<html lang="en">
  <head>
    <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    name="viewport"
  />
  <title>Drowning me></title>
  <link rel="stylesheet" href="/css/style.css">

<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>

  </head>
  <body>
    <div class="container">
      <header class="header">
  <div class="blog-title">
    <a href="/" class="logo">Drowning me</a>
  </div>
  <nav class="navbar">
    <ul class="menu">
      
      <li class="menu-item">
        <a href="/" class="menu-item-link"
          >home</a
        >
      </li>
      
      <li class="menu-item">
        <a href="/categories" class="menu-item-link"
          >categories</a
        >
      </li>
      
      <li class="menu-item">
        <a href="/tags" class="menu-item-link"
          >tags</a
        >
      </li>
      
      <li class="menu-item">
        <a href="/archives" class="menu-item-link"
          >archives</a
        >
      </li>
      
      <li class="menu-item">
        <a href="/about" class="menu-item-link"
          >about</a
        >
      </li>
      
    </ul>
  </nav>
</header>
 <article class="post">
    <div class="post-title">
        <h2 class="title">phpStudy 升级 MySQL 版本</h2>
    </div>
    <div class="post-meta">
        <span class="post-time">2020-12-13</span>
    </div>
    <div class="post-content">
        <h1 id="关于-phpStudy-升级-MySQL-版本这件事"><a href="#关于-phpStudy-升级-MySQL-版本这件事" class="headerlink" title="关于 phpStudy 升级 MySQL 版本这件事"></a>关于 phpStudy 升级 MySQL 版本这件事</h1><p>又是折腾了好几个小时。</p>
<a id="more"></a>

<h2 id="phpStudy"><a href="#phpStudy" class="headerlink" title="phpStudy"></a>phpStudy</h2><p>这是我用了很久的一个集成环境，最早的时候听了建议下载来用，也一直没换。伴着我度过了自己写项目，实践课大作业等等。总体来说还挺好用的，不过我使用的是 2018 版本，现在已经出了很多新版本。</p>
<p>它的优点有面板简洁，操作方便，集成完整，包括了 <code>php</code>、服务器和数据库，并且可以在不同版本之间切换。除了 <strong>数据库</strong> 。</p>
<h2 id="升级需求的由来"><a href="#升级需求的由来" class="headerlink" title="升级需求的由来"></a>升级需求的由来</h2><p>一切源自于我学习 Django ，写项目试图折腾一下无视图开发。</p>
<p>首先搜索了 RESTFUL 风格的 Django 开发，搜索到了一个库，但是我粗略地看了看，觉得太麻烦了。于是放弃，继续寻找原生 Django API 开发。在我的理念里，MVC 式开发就是在处理好数据后把数据塞进视图模板进行渲染，将页面返回给浏览器。而无视图开发，则是抛弃了视图模板，直接返回一些字符串文本而已。</p>
<p>翻了一下确实找到了，并且示例切换了 MySQL 数据库，而这，就是我那几个小时折腾的由来。</p>
<p>我切换了自己项目的数据库引擎，配置好账户、密码等等。然后我敲下数据库迁移命令。</p>
<p>也就报了几十行错误吧，滚轮滚滚还是能翻完的。</p>
<p>错误定位在此处：</p>
<p><img src="/2020/12/13/phpstudy-sheng-ji-mysql-ban-ben/image-20201213160542879.png" alt="image-20201213160542879"></p>
<p>可以看出此处出现了语法错误，我很迷惑，于是我翻找了 Django 官网的数据库连接教程。Django 提出可以定义文件来写入参数，我试了试，报了另外一个错。于是又回头去查这个错误的原因。</p>
<p>溯源很简单，网络给出了一个回答，曰：数据库版本过低，需要大于 5.x 以上。我大吃一惊，赶紧检查了 phpStudy 自带的数据库版本。就差一点点，就过线了。( 此处假装有图 )</p>
<p>没办法，我只能去找找怎么给 phpStudy 更换数据库版本。我隐约嗅到一丝要荒废时间的味道。因为许久之前，我忽略了 phpStudy 自带了一个数据库，而转头又去下了一个用。后来导致 phpStudy 无法面板启动 MySQL，那时候真是弄得焦头烂额。</p>
<h2 id="焦头烂额的下午"><a href="#焦头烂额的下午" class="headerlink" title="焦头烂额的下午"></a>焦头烂额的下午</h2><p>首先导出数据库内的数据，临时存储在桌面。</p>
<p>备份旧的 MySQL 的 my.ini 文件。</p>
<p>备份 phpStudy 的 MySQL 文件夹。</p>
<p>下载新版本数据库，解压到对应位置。</p>
<p>初始化数据库，安装数据库。</p>
<p>启动~</p>
<p>命令行亲切地提示我无法启动，于是我依着网上给 my.ini 中塞入了 <code>skip-grant-tables</code> 这一行。</p>
<p>不错，确实能启动了，然后我去修改密码。</p>
<p>交互命令行也亲切地抛出了错误。</p>
<p>提示没有 <code>mysql.user</code> 这个表。</p>
<p>于是我再次寻找成功更换的例子，并且重新再换了一份 MySQL 。</p>
<p><a href="https://www.jianshu.com/p/67ccce0e36e2" target="_blank" rel="noopener">此链接</a> 给了我较大帮助，但是依然存在一些问题。</p>
<p>首先是文中关于 <code>my.ini</code> 这个文件名的笔误。其次，我的 5.7.31 版本中 my.ini 依然需要放在 MySQL 路径下，放在 <code>bin</code> 当中并不起作用。关于卸载 MySQL 服务的命令也有一些问题。应该是：</p>
<pre class=" language-bash"><code class="language-bash">mysqld --remove xxx <span class="token comment" spellcheck="true"># xxx 为服务名</span></code></pre>
<p>我猜测是我的数据库服务名不是默认的，执行 <code>mysqld -remove</code> 会报错服务不存在。</p>
<p>依照文中给出的基础步骤。</p>
<ul>
<li>备份</li>
<li>下载新版本</li>
<li>卸载旧服务</li>
<li>初始化服务器</li>
<li>安装新服务</li>
<li>修改密码</li>
</ul>
<p>可以实现数据库的正常安装。</p>
<p>但是可能会导致 phpStudy 无法正常启动数据库。</p>
<p>原因很简单，数据库执行安装命令默认安装的服务名为 <code>MySQL</code> 。</p>
<p>但 phpStudy 启动的服务名为 <code>MySQLa</code> ，此处正确的做法是在执行安装命令时：</p>
<pre class=" language-bash"><code class="language-bash">mysqld --install MySQLa</code></pre>
<p>那么，就会得到我们需要的服务。</p>
<h3 id="关于启动数据库报错-1055-的问题。"><a href="#关于启动数据库报错-1055-的问题。" class="headerlink" title="关于启动数据库报错 1055 的问题。"></a>关于启动数据库报错 1055 的问题。</h3><p><a href="https://blog.csdn.net/xyy1028/article/details/79184545" target="_blank" rel="noopener">解决方法</a></p>
<h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>我没有进一步查阅关于 <code>MySQLa</code> 这个服务名是自定义的还是默认给出，是否可以自定义。</p>

    </div>
</article>
 <footer>
  <p>
    Theme is <a href="/" target="_blank">Theme-example</a> by
    <a href="https://s1rine.github.io" target="_blank">Sirine</a>
  </p>
  <p>
    Powered by
    <a href="https://hexo.io/" target="_blank" rel="nofollow">hexo</a>
    &copy; 2021
  </p>
</footer>

    </div>
  </body>
</html>
